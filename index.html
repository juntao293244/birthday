<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å†¬æ›²ç”Ÿæ—¥å¿«ä¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            position: relative;
            padding: 20px;
        }
        
        /* å¼€å§‹æŒ‰é’® */
        #startBtn {
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
            z-index: 10;
        }
        
        #startBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        
        /* å¼¹çª—å®¹å™¨ */
        .popup-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            pointer-events: none;
            overflow: hidden;
        }
        
        /* å•ä¸ªå¼¹çª—æ ·å¼ */
        .popup {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 250px;
            width: 90%;
            position: absolute;
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            pointer-events: auto;
        }
        
        .popup.active {
            transform: scale(1);
            opacity: 1;
        }
        
        .popup.exiting {
            transform: scale(0.8) translateY(-30px);
            opacity: 0;
        }
        
        /* ä¸ŠåŠéƒ¨åˆ†ä»å·¦åˆ°å³çš„è½®æ’­åŠ¨ç”» */
        .popup.marquee-top {
            animation: marquee-top 4s linear infinite;
        }
        
        /* ä¸‹åŠéƒ¨åˆ†ä»å³åˆ°å·¦çš„è½®æ’­åŠ¨ç”» */
        .popup.marquee-bottom {
            animation: marquee-bottom 4s linear infinite;
        }
        
        @keyframes marquee-top {
            0% {
                transform: translateX(-300px) scale(0.8);
                opacity: 0;
            }
            10% {
                transform: translateX(-200px) scale(1);
                opacity: 1;
            }
            90% {
                transform: translateX(calc(100vw + 100px)) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateX(calc(100vw + 300px)) scale(0.8);
                opacity: 0;
            }
        }
        
        @keyframes marquee-bottom {
            0% {
                transform: translateX(calc(100vw + 300px)) scale(0.8);
                opacity: 0;
            }
            10% {
                transform: translateX(calc(100vw + 100px)) scale(1);
                opacity: 1;
            }
            90% {
                transform: translateX(-200px) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateX(-300px) scale(0.8);
                opacity: 0;
            }
        }
        
        .popup p {
            color: #333;
            line-height: 1.3;
            margin: 0;
            font-size: 0.9em;
        }
        
        /* ä¸»é¢˜è‰² */
        .theme-1 { border-left: 3px solid #e91e63; }
        .theme-2 { border-left: 3px solid #2196f3; }
        .theme-3 { border-left: 3px solid #4caf50; }
        .theme-4 { border-left: 3px solid #ff9800; }
        .theme-5 { border-left: 3px solid #9c27b0; }
        .theme-6 { border-left: 3px solid #00bcd4; }
        .theme-7 { border-left: 3px solid #8bc34a; }
        .theme-8 { border-left: 3px solid #ff5722; }
        .theme-9 { border-left: 3px solid #673ab7; }
        .theme-10 { border-left: 3px solid #795548; }
        
        /* èƒŒæ™¯è£…é¥° */
        .floating-emoji {
            position: fixed;
            font-size: 1.5em;
            opacity: 0.2;
            animation: float 6s infinite ease-in-out;
            z-index: 0;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(180deg); }
        }
        
        /* å°çˆ±å¿ƒæ ·å¼ */
        .floating-heart {
            position: fixed;
            font-size: 1.2em;
            color: #ff6b6b;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
            animation: heartFloat 8s linear infinite;
        }
        
        @keyframes heartFloat {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100px) translateX(20px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* è›‹ç³•å›¾ç‰‡æ ·å¼ */
        #cakeImage {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            z-index: 2000;
            opacity: 0;
            transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            display: none;
            width: 300px;
            max-width: 90%;
        }
        
        #cakeImage.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
        
        #cakeImage .cake {
            font-size: 100px;
            animation: bounce 1.5s infinite;
            display: block;
            margin: 0;
        }
        
        #cakeImage h1 {
            color: #e91e63;
            font-size: 2em;
            margin: 15px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        #cakeImage p {
            color: #666;
            font-size: 1.1em;
            margin-top: 10px;
        }
        
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* çƒŸèŠ±ç”»å¸ƒ */
        #fireworksCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1500;
            pointer-events: none;
            display: none;
        }
        
        /* éŸ³ä¹æ§åˆ¶æŒ‰é’® */
        #musicControl {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2em;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        
        #musicControl:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 1);
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 480px) {
            body {
                padding: 15px;
            }
            
            .popup {
                padding: 12px;
                max-width: 220px;
            }
            
            .popup p {
                font-size: 0.85em;
            }
            
            #startBtn {
                padding: 12px 25px;
                font-size: 1em;
            }
            
            #cakeImage {
                padding: 20px;
                width: 280px;
            }
            
            #cakeImage .cake {
                font-size: 80px;
            }
            
            #cakeImage h1 {
                font-size: 1.5em;
            }
            
            #musicControl {
                top: 10px;
                right: 10px;
                width: 35px;
                height: 35px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="floating-emoji" style="top:10%;left:10%;animation-delay:0s">ğŸˆ</div>
    <div class="floating-emoji" style="top:20%;right:15%;animation-delay:2s">ğŸ‚</div>
    <div class="floating-emoji" style="bottom:15%;left:20%;animation-delay:4s">ğŸ</div>
    <div class="floating-emoji" style="bottom:25%;right:10%;animation-delay:1s">âœ¨</div>
    
    <!-- çƒŸèŠ±ç”»å¸ƒ -->
    <canvas id="fireworksCanvas"></canvas>
    
    <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <button id="musicControl">ğŸµ</button>
    
    <!-- å¼€å§‹æŒ‰é’® -->
    <button id="startBtn">æ‰“å¼€æƒŠå–œ</button>
    
    <!-- å¼¹çª—å®¹å™¨ -->
    <div id="popupContainer" class="popup-container" style="display:none;"></div>
    
    <!-- è›‹ç³•å›¾ç‰‡ -->
    <div id="cakeImage">
        <div class="cake">ğŸ‚</div>
        <h1>å†¬æ›²ç”Ÿæ—¥å¿«ä¹</h1>
        <p>æ„¿ä½ çš„æ¯ä¸€å¤©éƒ½å……æ»¡æ¬¢ä¹å’ŒæƒŠå–œï¼</p>
    </div>
    
    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="bgMusic" loop>
        <!-- è¿™é‡Œå¯ä»¥æ›¿æ¢ä¸ºæ‚¨å–œæ¬¢çš„çº¯éŸ³ä¹URL -->
        <source src="https://assets.mixkit.co/music/preview/mixkit-inspiring-soft-ambient-156.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚
    </audio>

    <script>
        // 10ä¸ªä¸åŒçš„ç¥ç¦è¯­æ•°ç»„
        const blessings = [
            { message: "äº²çˆ±çš„å†¬æ›²ï¼Œæ¬¢è¿æ¥åˆ°è¿™ä¸ªç‰¹åˆ«çš„ç”Ÿæ—¥ç¥ç¦ï¼æ„¿ä½ æ–°çš„ä¸€å²å……æ»¡æ— é™å¯èƒ½ï¼", theme: "theme-1" },
            { message: "æ„¿ä½ æ–°çš„ä¸€å²ï¼Œçœ¼é‡Œæœ‰å…‰ï¼Œå¿ƒé‡Œæœ‰çˆ±ï¼Œç›®å…‰æ‰€åŠçš†æ˜¯ç¾å¥½ï¼", theme: "theme-2" },
            { message: "æ„¿ä½ çš„æ¯ä¸€å¤©éƒ½å……æ»¡é˜³å…‰å’Œæ¬¢ç¬‘ï¼Œæ‰€æœ‰çš„æ¢¦æƒ³éƒ½èƒ½å¦‚æœŸå®ç°ï¼", theme: "theme-3" },
            { message: "æ„¿å¥åº·ã€å¿«ä¹ã€å¹³å®‰æ°¸è¿œé™ªä¼´ç€ä½ ï¼Œæ–°çš„ä¸€å²æ›´åŠ ç²¾å½©ï¼", theme: "theme-4" },
            { message: "æ„¿ä½ çš„ç”Ÿæ´»åƒå½©è™¹ä¸€æ ·ç»šä¸½å¤šå½©ï¼Œæ¯ä¸€å¤©éƒ½æœ‰æ–°çš„æƒŠå–œï¼", theme: "theme-5" },
            { message: "æ„¿ä½ çš„ç¬‘å®¹æ°¸è¿œç¿çƒ‚ï¼Œå¿ƒæƒ…æ°¸è¿œç¾ä¸½ï¼Œå¹¸ç¦æ°¸è¿œç›¸ä¼´ï¼", theme: "theme-6" },
            { message: "æ„¿æ‰€æœ‰çš„å¥½è¿éƒ½å›´ç»•ç€ä½ ï¼Œæ‰€æœ‰çš„ç¾å¥½éƒ½å±äºä½ ï¼", theme: "theme-7" },
            { message: "æ„¿ä½ çš„æ™ºæ…§ä¸æ—¥ä¿±å¢ï¼Œå‹‡æ°”ä¸æ¢¦æƒ³åŒè¡Œï¼", theme: "theme-8" },
            { message: "æ„¿ä½ çš„ä¸–ç•Œå……æ»¡æ¸©æš–ï¼Œå¿ƒä¸­æ°¸è¿œä¿æŒç«¥çœŸï¼", theme: "theme-9" },
            { message: "æ„¿ä½ çš„æ¯ä¸€å¤©éƒ½åƒç”Ÿæ—¥ä¸€æ ·ç‰¹åˆ«ï¼Œå……æ»¡çˆ±ä¸æƒŠå–œï¼", theme: "theme-10" }
        ];

        let popupElements = [];
        let sequenceTimer = null;
        let heartTimer = null;
        let isMusicPlaying = false;
        let fireworksActive = false;
        const bgMusic = document.getElementById('bgMusic');
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        
        // è®¾ç½®Canvaså¤§å°
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // çƒŸèŠ±ç²’å­ç±»
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.radius = Math.random() * 2 + 1;
                this.speedX = Math.random() * 6 - 3;
                this.speedY = Math.random() * 6 - 3;
                this.alpha = 1;
                this.gravity = 0.05;
                this.decay = Math.random() * 0.015 + 0.005;
            }
            
            update() {
                this.speedY += this.gravity;
                this.x += this.speedX;
                this.y += this.speedY;
                this.alpha -= this.decay;
                return this.alpha > 0;
            }
            
            draw() {
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
            }
        }
        
        // çƒŸèŠ±ç±»
        class Firework {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.particles = [];
                this.colors = [
                    '#ff0000', '#ff9900', '#ffff00', '#00ff00', 
                    '#00ffff', '#0000ff', '#9900ff', '#ff00ff',
                    '#ff1493', '#00ff7f', '#ff4500', '#da70d6'
                ];
                this.createParticles();
            }
            
            createParticles() {
                const particleCount = 200; // å¢åŠ ç²’å­æ•°é‡
                for (let i = 0; i < particleCount; i++) {
                    const color = this.colors[Math.floor(Math.random() * this.colors.length)];
                    this.particles.push(new Particle(this.x, this.y, color));
                }
            }
            
            update() {
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    if (!this.particles[i].update()) {
                        this.particles.splice(i, 1);
                    }
                }
                return this.particles.length > 0;
            }
            
            draw() {
                this.particles.forEach(particle => particle.draw());
            }
        }
        
        let fireworks = [];
        
        // åˆ›å»ºçƒŸèŠ±
        function createFirework() {
            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height * 0.6;
            fireworks.push(new Firework(x, y));
        }
        
        // åŠ¨ç”»å¾ªç¯
        function animateFireworks() {
            if (!fireworksActive) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // æ›´æ–°å’Œç»˜åˆ¶æ‰€æœ‰çƒŸèŠ±
            for (let i = fireworks.length - 1; i >= 0; i--) {
                if (!fireworks[i].update()) {
                    fireworks.splice(i, 1);
                } else {
                    fireworks[i].draw();
                }
            }
            
            // éšæœºæ·»åŠ æ–°çƒŸèŠ±ï¼Œå¢åŠ é¢‘ç‡
            if (Math.random() < 0.1) {
                createFirework();
            }
            
            requestAnimationFrame(animateFireworks);
        }
        
        // å¼€å§‹çƒŸèŠ±æ•ˆæœ
        function startFireworks() {
            fireworksActive = true;
            canvas.style.display = 'block';
            resizeCanvas();
            animateFireworks();
            
            // åˆå§‹åˆ›å»ºå¤šä¸ªçƒŸèŠ±
            for (let i = 0; i < 5; i++) {
                setTimeout(() => createFirework(), i * 200);
            }
        }
        
        // åœæ­¢çƒŸèŠ±æ•ˆæœ
        function stopFireworks() {
            fireworksActive = false;
            canvas.style.display = 'none';
            fireworks = [];
        }
        
        // è·å–éšæœºä½ç½®
        function getRandomPosition() {
            const maxX = window.innerWidth - 260;
            const maxY = window.innerHeight - 200;
            const randomX = Math.max(10, Math.min(maxX, Math.floor(Math.random() * maxX)));
            const randomY = Math.max(10, Math.min(maxY, Math.floor(Math.random() * maxY)));
            
            return { x: randomX, y: randomY };
        }
        
        // åˆ›å»ºå¼¹çª—
        function createPopup(contentIndex, position = null, themeIndex = null) {
            const container = document.getElementById('popupContainer');
            const popup = document.createElement('div');
            const theme = themeIndex !== null ? `theme-${(themeIndex % 10) + 1}` : `theme-${(contentIndex % 10) + 1}`;
            
            popup.className = `popup ${theme}`;
            popup.id = `popup_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            
            const blessing = blessings[contentIndex % blessings.length];
            
            popup.innerHTML = `<p>${blessing.message}</p>`;
            
            if (position) {
                popup.style.left = position.x + 'px';
                popup.style.top = position.y + 'px';
            } else {
                const randomPos = getRandomPosition();
                popup.style.left = randomPos.x + 'px';
                popup.style.top = randomPos.y + 'px';
            }
            
            container.appendChild(popup);
            popupElements.push(popup);
            return popup;
        }
        
        // æ˜¾ç¤ºå¼¹çª—
        function showPopup(popup) {
            setTimeout(() => {
                popup.classList.add('active');
            }, 100);
        }
        
        // éšè—å¼¹çª—
        function hidePopup(popup, callback) {
            popup.classList.add('exiting');
            setTimeout(() => {
                popup.classList.remove('active', 'exiting');
                if (popup.parentNode) {
                    popup.parentNode.removeChild(popup);
                }
                const index = popupElements.indexOf(popup);
                if (index > -1) {
                    popupElements.splice(index, 1);
                }
                if (callback) callback();
            }, 300);
        }
        
        // åˆ›å»ºæ¼‚æµ®çˆ±å¿ƒ
        function createFloatingHeart() {
            const heart = document.createElement('div');
            heart.className = 'floating-heart';
            heart.innerHTML = 'â¤ï¸';
            heart.style.left = Math.random() * window.innerWidth + 'px';
            heart.style.animationDelay = Math.random() * 5 + 's';
            heart.style.animationDuration = (8 + Math.random() * 4) + 's';
            
            document.body.appendChild(heart);
            
            setTimeout(() => {
                if (heart.parentNode) {
                    heart.parentNode.removeChild(heart);
                }
            }, 12000);
        }
        
        // å¼€å§‹æ¼‚æµ®çˆ±å¿ƒæ•ˆæœ
        function startHearts() {
            for (let i = 0; i < 3; i++) {
                setTimeout(() => createFloatingHeart(), i * 2000);
            }
            
            heartTimer = setInterval(() => {
                createFloatingHeart();
            }, 3000);
        }
        
        // åœæ­¢æ¼‚æµ®çˆ±å¿ƒæ•ˆæœ
        function stopHearts() {
            clearInterval(heartTimer);
            document.querySelectorAll('.floating-heart').forEach(heart => {
                if (heart.parentNode) {
                    heart.parentNode.removeChild(heart);
                }
            });
        }
        
        // å¼€å§‹éšæœºå¼¹çª—åºåˆ—
        function startRandomSequence() {
            clearTimeout(sequenceTimer);
            let randomCount = 0;
            const maxRandomTime = 20000;
            const startTime = Date.now();
            
            function addRandomPopup() {
                if (Date.now() - startTime >= maxRandomTime) {
                    startMarqueeEffect();
                    return;
                }
                
                const randomIndex = Math.floor(Math.random() * blessings.length);
                const randomPosition = getRandomPosition();
                const newPopup = createPopup(randomIndex, randomPosition, randomIndex);
                showPopup(newPopup);
                randomCount++;
                
                const nextInterval = 80 + Math.random() * 120;
                sequenceTimer = setTimeout(addRandomPopup, nextInterval);
            }
            
            addRandomPopup();
        }
        
        // è½®æ’­æ•ˆæœ
        function startMarqueeEffect() {
            popupElements.forEach(popup => {
                if (popup.parentNode) {
                    popup.parentNode.removeChild(popup);
                }
            });
            popupElements = [];
            
            const container = document.getElementById('popupContainer');
            const screenHeight = window.innerHeight;
            
            // åˆ›å»ºä¸ŠåŠéƒ¨åˆ†å¼¹çª—ï¼ˆä»å·¦åˆ°å³ï¼‰
            for (let i = 0; i < 12; i++) {
                const popup = document.createElement('div');
                const theme = `theme-${(i % 10) + 1}`;
                const blessing = blessings[i % blessings.length];
                
                popup.className = `popup ${theme} marquee-top`;
                popup.style.animationDelay = (i * 0.3) + 's';
                popup.style.top = (Math.random() * (screenHeight / 2 + 100)) + 'px';
                
                popup.innerHTML = `<p>${blessing.message}</p>`;
                
                container.appendChild(popup);
                popupElements.push(popup);
            }
            
            // åˆ›å»ºä¸‹åŠéƒ¨åˆ†å¼¹çª—ï¼ˆä»å³åˆ°å·¦ï¼‰
            for (let i = 0; i < 12; i++) {
                const popup = document.createElement('div');
                const theme = `theme-${((i + 6) % 10) + 1}`;
                const blessing = blessings[(i + 6) % blessings.length];
                
                popup.className = `popup ${theme} marquee-bottom`;
                popup.style.animationDelay = (i * 0.3) + 's';
                popup.style.top = (screenHeight / 2 - 100 + Math.random() * (screenHeight / 2 + 100)) + 'px';
                
                popup.innerHTML = `<p>${blessing.message}</p>`;
                
                container.appendChild(popup);
                popupElements.push(popup);
            }
            
            setTimeout(() => {
                showCakeImage();
            }, 12000);
        }
        
        // æ˜¾ç¤ºè›‹ç³•å›¾ç‰‡
        function showCakeImage() {
            popupElements.forEach(popup => {
                if (popup.parentNode) {
                    popup.parentNode.removeChild(popup);
                }
            });
            popupElements = [];
            
            document.getElementById('popupContainer').style.display = 'none';
            
            // å¼€å§‹çƒŸèŠ±æ•ˆæœ
            startFireworks();
            
            const cakeImage = document.getElementById('cakeImage');
            cakeImage.style.display = 'block';
            
            setTimeout(() => {
                cakeImage.classList.add('active');
            }, 100);
            
            // ä¸å†éšè—è›‹ç³•å’Œæ˜¾ç¤ºé‡æ–°æ’­æ”¾æŒ‰é’®
            // é¡µé¢å°†ä¸€ç›´æ˜¾ç¤ºè›‹ç³•å’ŒçƒŸèŠ±
        }
        
        // é‡æ–°å¼€å§‹
        function restart(showStartBtn = true) {
            const cakeImage = document.getElementById('cakeImage');
            cakeImage.classList.remove('active');
            cakeImage.style.display = 'none';
            
            stopFireworks();
            
            popupElements.forEach(popup => {
                if (popup.parentNode) {
                    popup.parentNode.removeChild(popup);
                }
            });
            popupElements = [];
            
            if (showStartBtn) {
                document.getElementById('startBtn').style.display = 'block';
            } else {
                document.getElementById('startBtn').style.display = 'none';
            }
            
            document.getElementById('popupContainer').style.display = 'none';
            document.getElementById('popupContainer').innerHTML = '';
            
            clearTimeout(sequenceTimer);
        }
        
        // å¼€å§‹å±•ç¤ºå¼¹çª—
        document.getElementById('startBtn').addEventListener('click', function() {
            this.style.display = 'none';
            document.getElementById('popupContainer').style.display = 'block';
            
            if (!isMusicPlaying) {
                bgMusic.play().catch(e => {
                    console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’');
                });
                isMusicPlaying = true;
                document.getElementById('musicControl').textContent = 'ğŸ”Š';
            }
            
            startHearts();
            startRandomSequence();
        });
        
        // éŸ³ä¹æ§åˆ¶æŒ‰é’®
        document.getElementById('musicControl').addEventListener('click', function() {
            if (isMusicPlaying) {
                bgMusic.pause();
                this.textContent = 'ğŸ”‡';
            } else {
                bgMusic.play();
                this.textContent = 'ğŸ”Š';
            }
            isMusicPlaying = !isMusicPlaying;
        });
        
        // ESCé”®æ”¯æŒ
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                restart();
                stopHearts();
            }
        });
        
        // çª—å£å¤§å°å˜åŒ–æ—¶é‡æ–°è®¡ç®—ä½ç½®
        window.addEventListener('resize', function() {
            popupElements.forEach((popup, index) => {
                if (popup && popup.id.includes('popup_')) {
                    const newPosition = getRandomPosition();
                    popup.style.left = newPosition.x + 'px';
                    popup.style.top = newPosition.y + 'px';
                }
            });
            
            resizeCanvas();
        });
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', function() {
            bgMusic.volume = 0.5;
            resizeCanvas();
        });
    </script>
</body>
</html>
